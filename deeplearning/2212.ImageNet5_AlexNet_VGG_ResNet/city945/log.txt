baseline:
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.83it/s]
epoch 1, loss sum 260.004, train acc 0.373, test acc 0.505
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.93it/s]
epoch 2, loss sum 211.834, train acc 0.553, test acc 0.655
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.77it/s]
epoch 3, loss sum 179.947, train acc 0.634, test acc 0.732
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.44it/s]
epoch 4, loss sum 160.159, train acc 0.675, test acc 0.775
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.19it/s]
epoch 5, loss sum 151.830, train acc 0.700, test acc 0.763
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.87it/s]
epoch 6, loss sum 144.801, train acc 0.719, test acc 0.775
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.33it/s]
epoch 7, loss sum 134.816, train acc 0.742, test acc 0.842
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.49it/s]
epoch 8, loss sum 126.050, train acc 0.752, test acc 0.755
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.84it/s]
epoch 9, loss sum 120.918, train acc 0.768, test acc 0.815
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.77it/s]
epoch 10, loss sum 118.830, train acc 0.774, test acc 0.828
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.24it/s]
epoch 11, loss sum 111.604, train acc 0.783, test acc 0.842
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.65it/s]
epoch 12, loss sum 108.201, train acc 0.786, test acc 0.818
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.79it/s]
epoch 13, loss sum 103.711, train acc 0.796, test acc 0.857
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.52it/s]
epoch 14, loss sum 103.577, train acc 0.800, test acc 0.849
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.73it/s]
epoch 15, loss sum 100.047, train acc 0.805, test acc 0.858
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.62it/s]
epoch 16, loss sum 100.029, train acc 0.810, test acc 0.871
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:21<00:00,  8.64it/s]
epoch 17, loss sum 94.336, train acc 0.815, test acc 0.855
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:19<00:00,  9.24it/s]
epoch 18, loss sum 94.157, train acc 0.819, test acc 0.874
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:21<00:00,  8.34it/s]
epoch 19, loss sum 93.090, train acc 0.822, test acc 0.851
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:22<00:00,  8.03it/s]
epoch 20, loss sum 89.687, train acc 0.825, test acc 0.849

batch_size 32 -> 256 lr 0.0002 -> 0.002 不收敛
epoch 1, loss sum 251.448, train acc 0.211, test acc 0.200
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:23<00:00,  1.04s/it]
epoch 2, loss sum 37.060, train acc 0.206, test acc 0.200
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:23<00:00,  1.03s/it]
epoch 3, loss sum 37.020, train acc 0.199, test acc 0.200
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.77it/s]
epoch 4, loss sum 36.998, train acc 0.199, test acc 0.212
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.69it/s]
epoch 5, loss sum 36.978, train acc 0.210, test acc 0.203
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.77it/s]
epoch 6, loss sum 36.986, train acc 0.206, test acc 0.200
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.71it/s]
epoch 7, loss sum 37.104, train acc 0.200, test acc 0.200
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.72it/s]
epoch 8, loss sum 37.029, train acc 0.191, test acc 0.200

drop transforms.Normalize, batch_size 32 -> 256 lr 0.0002 -> 0.002 不收敛
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.86it/s]
epoch 1, loss sum 241.197, train acc 0.201, test acc 0.200
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.87it/s]
epoch 2, loss sum 41.903, train acc 0.200, test acc 0.200

batch_size 32 -> 256:
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.79it/s]
epoch 1, loss sum 36.118, train acc 0.281, test acc 0.268
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.77it/s]
epoch 2, loss sum 32.680, train acc 0.369, test acc 0.489
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.77it/s]
epoch 3, loss sum 29.621, train acc 0.468, test acc 0.580
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.78it/s]
epoch 4, loss sum 26.824, train acc 0.548, test acc 0.648
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.80it/s]
epoch 5, loss sum 24.436, train acc 0.584, test acc 0.725
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.72it/s]
epoch 6, loss sum 22.208, train acc 0.638, test acc 0.643
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.74it/s]
epoch 7, loss sum 20.998, train acc 0.662, test acc 0.765
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.76it/s]
epoch 8, loss sum 18.223, train acc 0.709, test acc 0.765
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.76it/s]
epoch 9, loss sum 17.901, train acc 0.719, test acc 0.786
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.74it/s]
epoch 10, loss sum 16.294, train acc 0.744, test acc 0.788
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.78it/s]
epoch 11, loss sum 16.453, train acc 0.744, test acc 0.780
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.83it/s]
epoch 12, loss sum 14.963, train acc 0.761, test acc 0.834
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.81it/s]
epoch 13, loss sum 14.457, train acc 0.772, test acc 0.845
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.80it/s]
epoch 14, loss sum 14.400, train acc 0.776, test acc 0.798
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.82it/s]
epoch 15, loss sum 13.732, train acc 0.781, test acc 0.843
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.76it/s]
epoch 16, loss sum 13.013, train acc 0.800, test acc 0.862
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.74it/s]
epoch 17, loss sum 12.350, train acc 0.804, test acc 0.863
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.68it/s]
epoch 18, loss sum 12.534, train acc 0.807, test acc 0.858
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.78it/s]
epoch 19, loss sum 11.878, train acc 0.816, test acc 0.854
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.78it/s]
epoch 20, loss sum 12.457, train acc 0.808, test acc 0.872

batch_size 32 -> 256 lr 0.0002 -> 0.00002 
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.74it/s]
epoch 1, loss sum 36.813, train acc 0.248, test acc 0.315
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.73it/s]
epoch 2, loss sum 35.326, train acc 0.314, test acc 0.420
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.78it/s]
epoch 3, loss sum 32.378, train acc 0.400, test acc 0.448
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.73it/s]
epoch 4, loss sum 31.038, train acc 0.434, test acc 0.511
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.71it/s]
epoch 5, loss sum 29.985, train acc 0.467, test acc 0.525
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.78it/s]
epoch 6, loss sum 28.688, train acc 0.493, test acc 0.549
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.78it/s]
epoch 7, loss sum 27.873, train acc 0.514, test acc 0.595
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.81it/s]
epoch 8, loss sum 26.587, train acc 0.535, test acc 0.620
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.78it/s]
epoch 9, loss sum 26.109, train acc 0.557, test acc 0.588
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.77it/s]
epoch 10, loss sum 25.607, train acc 0.555, test acc 0.600
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.75it/s]
epoch 11, loss sum 24.885, train acc 0.569, test acc 0.666
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.76it/s]
epoch 12, loss sum 23.558, train acc 0.603, test acc 0.666
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.80it/s]
epoch 13, loss sum 22.871, train acc 0.617, test acc 0.708
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.71it/s]
epoch 14, loss sum 22.813, train acc 0.615, test acc 0.709
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.79it/s]
epoch 15, loss sum 22.097, train acc 0.636, test acc 0.705
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:13<00:00,  1.76it/s]
epoch 16, loss sum 21.689, train acc 0.643, test acc 0.705
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.81it/s]
epoch 17, loss sum 20.997, train acc 0.656, test acc 0.752
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.82it/s]
epoch 18, loss sum 20.373, train acc 0.669, test acc 0.758
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.79it/s]
epoch 19, loss sum 20.084, train acc 0.668, test acc 0.740
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:12<00:00,  1.78it/s]
epoch 20, loss sum 19.503, train acc 0.684, test acc 0.757


init_weights=False:
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.48it/s]
epoch 1, loss sum 269.231, train acc 0.329, test acc 0.498
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.61it/s]
epoch 2, loss sum 221.891, train acc 0.510, test acc 0.577
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.72it/s]
epoch 3, loss sum 193.799, train acc 0.594, test acc 0.652
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.37it/s]
epoch 4, loss sum 170.443, train acc 0.654, test acc 0.746
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.71it/s]
epoch 5, loss sum 161.567, train acc 0.679, test acc 0.772
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.61it/s]
epoch 6, loss sum 147.562, train acc 0.710, test acc 0.763
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.88it/s]
epoch 7, loss sum 138.259, train acc 0.730, test acc 0.806
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.93it/s]
epoch 8, loss sum 136.905, train acc 0.729, test acc 0.805
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.92it/s]
epoch 9, loss sum 128.444, train acc 0.744, test acc 0.768
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.75it/s]
epoch 10, loss sum 126.020, train acc 0.757, test acc 0.838
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.54it/s]
epoch 11, loss sum 118.856, train acc 0.771, test acc 0.832
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.69it/s]
epoch 12, loss sum 119.419, train acc 0.772, test acc 0.803
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.62it/s]
epoch 13, loss sum 113.392, train acc 0.784, test acc 0.823
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.61it/s]
epoch 14, loss sum 107.045, train acc 0.792, test acc 0.832
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.92it/s]
epoch 15, loss sum 104.087, train acc 0.803, test acc 0.843
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.82it/s]
epoch 16, loss sum 104.242, train acc 0.798, test acc 0.797
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.70it/s]
epoch 17, loss sum 101.929, train acc 0.800, test acc 0.845
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.93it/s]
epoch 18, loss sum 98.860, train acc 0.809, test acc 0.866
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.95it/s]
epoch 19, loss sum 95.159, train acc 0.811, test acc 0.863
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.83it/s]
epoch 20, loss sum 95.715, train acc 0.813, test acc 0.875


drop dropout:
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.75it/s]
epoch 1, loss sum 264.965, train acc 0.350, test acc 0.458
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 15.00it/s]
epoch 2, loss sum 231.320, train acc 0.493, test acc 0.654
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 15.01it/s]
epoch 3, loss sum 188.922, train acc 0.614, test acc 0.726
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.99it/s]
epoch 4, loss sum 170.822, train acc 0.657, test acc 0.769
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.89it/s]
epoch 5, loss sum 158.361, train acc 0.685, test acc 0.792
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.72it/s]
epoch 6, loss sum 144.684, train acc 0.710, test acc 0.783
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.74it/s]
epoch 7, loss sum 134.835, train acc 0.736, test acc 0.794
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.97it/s]
epoch 8, loss sum 128.375, train acc 0.751, test acc 0.823
 95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌    97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍ 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.81it/s]
epoch 9, loss sum 125.845, train acc 0.757, test acc 0.812
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.66it/s]
epoch 10, loss sum 116.372, train acc 0.775, test acc 0.831
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.59it/s]
epoch 11, loss sum 112.713, train acc 0.781, test acc 0.842
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.68it/s]
epoch 12, loss sum 110.118, train acc 0.788, test acc 0.828
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.89it/s]
epoch 13, loss sum 107.274, train acc 0.789, test acc 0.875
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.23it/s]
epoch 14, loss sum 103.480, train acc 0.800, test acc 0.858
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.87it/s]
epoch 15, loss sum 97.774, train acc 0.807, test acc 0.866
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.93it/s]
epoch 16, loss sum 97.668, train acc 0.808, test acc 0.862
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 15.11it/s]
epoch 17, loss sum 92.070, train acc 0.824, test acc 0.872
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.57it/s]
epoch 18, loss sum 93.434, train acc 0.821, test acc 0.862
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 14.76it/s]
epoch 19, loss sum 93.787, train acc 0.817, test acc 0.883
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 183/183 [00:12<00:00, 15.01it/s]
epoch 20, loss sum 89.660, train acc 0.827, test acc 0.869

-------------------------------------------------------------------------------------------------------------------------------

VGG16
baseline:
epoch 6, loss sum 377.548, train acc 0.624, test acc 0.700
epoch 7, loss sum 353.366, train acc 0.652, test acc 0.746
epoch 8, loss sum 351.273, train acc 0.655, test acc 0.651
epoch 9, loss sum 332.734, train acc 0.666, test acc 0.618
epoch 10, loss sum 334.623, train acc 0.671, test acc 0.778
epoch 11, loss sum 327.663, train acc 0.683, test acc 0.762
epoch 12, loss sum 308.191, train acc 0.704, test acc 0.811
epoch 13, loss sum 307.402, train acc 0.697, test acc 0.806
epoch 14, loss sum 284.414, train acc 0.725, test acc 0.817
epoch 15, loss sum 297.602, train acc 0.715, test acc 0.760
epoch 16, loss sum 280.918, train acc 0.727, test acc 0.846
epoch 17, loss sum 272.076, train acc 0.739, test acc 0.788
epoch 18, loss sum 273.149, train acc 0.740, test acc 0.869
epoch 19, loss sum 253.750, train acc 0.760, test acc 0.855
epoch 20, loss sum 232.143, train acc 0.779, test acc 0.855

finetune last layer:
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 366/366 [00:48<00:00,  7.50it/s]
epoch 1, loss sum 106.113, train acc 0.917, test acc 0.982
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 366/366 [00:49<00:00,  7.47it/s]
epoch 2, loss sum 54.930, train acc 0.949, test acc 0.983
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 366/366 [00:49<00:00,  7.37it/s]
epoch 3, loss sum 45.167, train acc 0.956, test acc 0.985
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 366/366 [00:49<00:00,  7.37it/s]
epoch 4, loss sum 44.708, train acc 0.957, test acc 0.989
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 366/366 [00:49<00:00,  7.33it/s]
epoch 5, loss sum 41.992, train acc 0.955, test acc 0.985

finetune whole net:
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 366/366 [01:00<00:00,  6.05it/s]
epoch 1, loss sum 220.192, train acc 0.793, test acc 0.942
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 366/366 [01:00<00:00,  6.02it/s]
epoch 2, loss sum 145.766, train acc 0.869, test acc 0.963
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 366/366 [01:00<00:00,  6.05it/s]
epoch 3, loss sum 127.106, train acc 0.890, test acc 0.943
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 366/366 [01:00<00:00,  6.04it/s]
epoch 4, loss sum 122.146, train acc 0.889, test acc 0.918
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 366/366 [01:00<00:00,  6.03it/s]
epoch 5, loss sum 133.797, train acc 0.878, test acc 0.962
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 366/366 [01:00<00:00,  6.05it/s]
epoch 6, loss sum 106.990, train acc 0.906, test acc 0.972
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 366/366 [01:00<00:00,  6.04it/s]
epoch 7, loss sum 103.258, train acc 0.912, test acc 0.963
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 366/366 [01:00<00:00,  6.03it/s]
epoch 8, loss sum 98.939, train acc 0.909, test acc 0.966
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 366/366 [01:00<00:00,  6.03it/s]
epoch 9, loss sum 91.540, train acc 0.916, test acc 0.934
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 366/366 [01:00<00:00,  6.04it/s]
epoch 10, loss sum 86.335, train acc 0.921, test acc 0.960
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 366/366 [01:00<00:00,  6.03it/s]
epoch 11, loss sum 90.115, train acc 0.917, test acc 0.955
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 366/366 [01:00<00:00,  6.04it/s]
epoch 12, loss sum 92.179, train acc 0.919, test acc 0.960
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 366/366 [01:00<00:00,  6.05it/s]
epoch 13, loss sum 96.634, train acc 0.912, test acc 0.957

Flower5 baseline:
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:39<00:00,  5.26it/s]
epoch 1, loss sum 1044.558, train acc 0.254, test acc 0.379
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:39<00:00,  5.28it/s]
epoch 2, loss sum 316.323, train acc 0.368, test acc 0.415
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:39<00:00,  5.21it/s]
epoch 3, loss sum 294.733, train acc 0.409, test acc 0.478
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:40<00:00,  5.15it/s]
epoch 4, loss sum 278.459, train acc 0.425, test acc 0.544
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:40<00:00,  5.15it/s]
epoch 5, loss sum 270.522, train acc 0.455, test acc 0.558
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:40<00:00,  5.14it/s]
epoch 6, loss sum 250.543, train acc 0.514, test acc 0.538
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:40<00:00,  5.14it/s]
epoch 7, loss sum 243.948, train acc 0.538, test acc 0.552
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:40<00:00,  5.16it/s]
epoch 8, loss sum 231.423, train acc 0.558, test acc 0.599
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:40<00:00,  5.14it/s]
epoch 9, loss sum 231.030, train acc 0.561, test acc 0.610
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:40<00:00,  5.15it/s]
epoch 10, loss sum 221.000, train acc 0.574, test acc 0.525
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:40<00:00,  5.15it/s]
epoch 11, loss sum 214.213, train acc 0.588, test acc 0.604
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:40<00:00,  5.15it/s]
epoch 12, loss sum 209.086, train acc 0.604, test acc 0.582
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:40<00:00,  5.16it/s]
epoch 13, loss sum 213.514, train acc 0.600, test acc 0.676
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:40<00:00,  5.14it/s]
epoch 14, loss sum 209.127, train acc 0.613, test acc 0.659
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:40<00:00,  5.14it/s]
epoch 15, loss sum 207.996, train acc 0.613, test acc 0.626
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:40<00:00,  5.15it/s]
epoch 16, loss sum 202.717, train acc 0.623, test acc 0.676
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:40<00:00,  5.15it/s]
epoch 17, loss sum 198.462, train acc 0.629, test acc 0.687
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:40<00:00,  5.15it/s]
epoch 18, loss sum 196.664, train acc 0.636, test acc 0.706
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:40<00:00,  5.15it/s]
epoch 19, loss sum 189.955, train acc 0.652, test acc 0.695
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:40<00:00,  5.16it/s]
epoch 20, loss sum 192.936, train acc 0.646, test acc 0.577

Flower5 last layer:
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:27<00:00,  7.48it/s]
epoch 1, loss sum 179.186, train acc 0.698, test acc 0.838
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:27<00:00,  7.50it/s]
epoch 2, loss sum 116.423, train acc 0.802, test acc 0.849
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:28<00:00,  7.35it/s]
epoch 3, loss sum 103.451, train acc 0.827, test acc 0.843
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:28<00:00,  7.35it/s]
epoch 4, loss sum 95.072, train acc 0.842, test acc 0.843
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:28<00:00,  7.30it/s]
epoch 5, loss sum 94.065, train acc 0.839, test acc 0.843
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:28<00:00,  7.34it/s]
epoch 6, loss sum 90.666, train acc 0.842, test acc 0.852
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:28<00:00,  7.33it/s]
epoch 7, loss sum 84.485, train acc 0.858, test acc 0.843
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:28<00:00,  7.27it/s]
epoch 8, loss sum 84.938, train acc 0.855, test acc 0.857
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:28<00:00,  7.33it/s]
epoch 9, loss sum 81.324, train acc 0.862, test acc 0.857
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:28<00:00,  7.32it/s]
epoch 10, loss sum 80.165, train acc 0.865, test acc 0.857
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:28<00:00,  7.23it/s]
epoch 11, loss sum 81.171, train acc 0.858, test acc 0.849

Flower5 whole net:
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:34<00:00,  6.04it/s]
epoch 1, loss sum 220.666, train acc 0.604, test acc 0.712
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:34<00:00,  6.04it/s]
epoch 2, loss sum 144.143, train acc 0.761, test acc 0.794
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:34<00:00,  5.99it/s]
epoch 3, loss sum 125.179, train acc 0.796, test acc 0.887
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:34<00:00,  6.03it/s]
epoch 4, loss sum 135.247, train acc 0.779, test acc 0.904
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:34<00:00,  6.02it/s]
epoch 5, loss sum 101.455, train acc 0.828, test acc 0.907
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:34<00:00,  6.03it/s]
epoch 6, loss sum 89.963, train acc 0.847, test acc 0.893
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:34<00:00,  6.04it/s]
epoch 7, loss sum 106.550, train acc 0.833, test acc 0.876
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:34<00:00,  6.01it/s]
epoch 8, loss sum 89.043, train acc 0.851, test acc 0.852
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:34<00:00,  6.02it/s]
epoch 9, loss sum 83.223, train acc 0.861, test acc 0.904
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:34<00:00,  6.02it/s]
epoch 10, loss sum 78.306, train acc 0.868, test acc 0.854
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:34<00:00,  6.03it/s]
epoch 11, loss sum 75.279, train acc 0.874, test acc 0.923
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:34<00:00,  6.02it/s]
epoch 12, loss sum 76.649, train acc 0.870, test acc 0.898
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:34<00:00,  6.04it/s]
epoch 13, loss sum 73.798, train acc 0.872, test acc 0.901
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [00:34<00:00,  6.03it/s]
epoch 14, loss sum 79.904, train acc 0.868, test acc 0.898